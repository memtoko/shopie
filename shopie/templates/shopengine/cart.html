{% extends "base.html" %}
{% load i18n %}
{% block title %}{% trans "Keranjang Belanja" %}{% endblock %}
{% include "partials/messages.html" %}
{% block content %}
<div class="page-wrapper">
  <div class="row">
    <article class="page-article">
      <header class="entry-header">
        <h1 class="entry-title">Keranjang Belanja Anda</h1>
      </header>
      {% if cart_items %}
        <form class="form-class" method="post" action="{% url 'cart_update' %}">
          {% csrf_token %}
          {{ formset.management_form }}
          <table class="cart-table large-12" role="grid">
            <thead>
              <tr>
                <th>Product name</th>
                <th>Unit price</th>
                <th>Quantity</th>
                <th>&nbsp;</th>
              </tr>
            </thead>
            <tbody>
              {% for form in formset %}
              {% with form.quantity as field %}
                <tr>
                  <td>{{ form.instance.product.fullname }}</td>
                  <td>{{ form.instance.product.unit_price }}</td>
                  <td>{{ form.id }}{{ field.errors }}{{ field }}</td>
                  <td>{{ form.instance.line_total }}</td>
                </tr>
                {% for extra_price_field in form.instance.extra_price_fields %}
                  <tr>
                    <td colspan="2">&nbsp;</td>
                    <td>{{ extra_price_field.0 }}</td>
                    <td>{{ extra_price_field.1 }}</td>
                  </tr>
                {% endfor %}
                <tr><td colspan="2">&nbsp;</td><td>Line Total:</td><td>{{ form.instance.line_total }}</td></tr>
              {% endwith %}
              {% endfor %}
            </tbody>

            <tfoot>
              <tr><td colspan="2">&nbsp;</td><td>Cart Subtotal</td><td>{{cart.subtotal_price}}</td></tr>
              {% for extra_price_field in cart.extra_price_fields %}
                <tr>
                  <td colspan="2">&nbsp;</td>
                  <td>{{ extra_price_field.0 }}</td>
                  <td>{{ extra_price_field.1 }}</td>
                </tr>
              {% endfor %}
              <tr><td colspan="2">&nbsp;</td><td><b>Cart Total</b></td><td><b>{{cart.total_price}}</b></td></tr>
            </tfoot>
            <p><input type="submit" class="small button round" value="Update Shopping Cart"/></p>
          </table>
        </form>
      {% endif %}
    </article>
  </div>
</div>
{% endblock %}
